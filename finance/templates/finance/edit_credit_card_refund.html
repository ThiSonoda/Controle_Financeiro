{% extends "finance/base.html" %}
{% load static %}

{% block content %}
<h1>Editar Estorno de Cartão de Crédito</h1>

{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}

<form method="post" action="">
  {% csrf_token %}
  <div style="background-color: #f5f5f5; padding: 20px; border-radius: 6px; max-width: 800px;">
    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 15px;">
      <div>
        <label for="credit_card">Cartão de Crédito: *</label>
        <select id="credit_card" name="credit_card" required style="width: 100%; padding: 8px; box-sizing: border-box;">
          {% for card in credit_cards %}
            <option value="{{ card.id }}" {% if card.id == refund.credit_card.id %}selected{% endif %}>{{ card.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div>
        <label for="amount">Valor: *</label>
        <input type="number" id="amount" name="amount" step="0.01" min="0.01" required style="width: 100%; padding: 8px; box-sizing: border-box;" value="{{ refund.amount }}">
      </div>
      <div>
        <label for="refund_date">Data do Estorno: *</label>
        <input type="date" id="refund_date" name="refund_date" required style="width: 100%; padding: 8px; box-sizing: border-box;" value="{{ refund.refund_date|date:'Y-m-d' }}">
      </div>
      <div>
        <label for="invoice_year">Ano da Fatura: *</label>
        <input type="number" id="invoice_year" name="invoice_year" required style="width: 100%; padding: 8px; box-sizing: border-box;" value="{{ refund.invoice_year }}" min="2020" max="2100">
      </div>
      <div>
        <label for="invoice_month">Mês da Fatura: *</label>
        <select id="invoice_month" name="invoice_month" required style="width: 100%; padding: 8px; box-sizing: border-box;">
          <option value="1" {% if refund.invoice_month == 1 %}selected{% endif %}>Janeiro</option>
          <option value="2" {% if refund.invoice_month == 2 %}selected{% endif %}>Fevereiro</option>
          <option value="3" {% if refund.invoice_month == 3 %}selected{% endif %}>Março</option>
          <option value="4" {% if refund.invoice_month == 4 %}selected{% endif %}>Abril</option>
          <option value="5" {% if refund.invoice_month == 5 %}selected{% endif %}>Maio</option>
          <option value="6" {% if refund.invoice_month == 6 %}selected{% endif %}>Junho</option>
          <option value="7" {% if refund.invoice_month == 7 %}selected{% endif %}>Julho</option>
          <option value="8" {% if refund.invoice_month == 8 %}selected{% endif %}>Agosto</option>
          <option value="9" {% if refund.invoice_month == 9 %}selected{% endif %}>Setembro</option>
          <option value="10" {% if refund.invoice_month == 10 %}selected{% endif %}>Outubro</option>
          <option value="11" {% if refund.invoice_month == 11 %}selected{% endif %}>Novembro</option>
          <option value="12" {% if refund.invoice_month == 12 %}selected{% endif %}>Dezembro</option>
        </select>
      </div>
    </div>
    <div style="margin-bottom: 15px;">
      <label for="description">Descrição: *</label>
      <textarea id="description" name="description" required style="width: 100%; padding: 8px; box-sizing: border-box; min-height: 100px;">{{ refund.description }}</textarea>
    </div>
    <div>
      <button type="submit" style="padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Salvar Alterações</button>
      <a href="{% url 'finance:credit_card_refunds' %}" style="padding: 10px 20px; background-color: #999; color: white; text-decoration: none; border-radius: 4px; margin-left: 10px; display: inline-block;">Cancelar</a>
    </div>
  </div>
</form>

{% endblock %}
